{% load packets_extras %}
    <div class="card">
        <div class="card-header">
            Analysis
        </div>
        <div class="card-body">
            <h5 class="card-title">About BROWSER</h5>
            <p class="card-text">The following information was detected analyzing only packets from this protocol:</p>
            <ul>
                <!-- MANUFACTURER -->
                {% for manufacturer in protocol_info|fields:"BROWSER"|fields:"manufacturer" %}
                <li><strong>Manufacturer detected:</strong> {{ manufacturer }}</li>
                {% endfor %}

                <!-- IP -->
                {% for ip in protocol_info|fields:"BROWSER"|fields:"ip" %}
                <li><strong>IP detected:</strong> {{ ip }}</li>
                {% endfor %}

                <!-- OPERATING SYSTEM -->
                {% for ttl in protocol_info|fields:"BROWSER"|fields:"ttl" %}
                    {% if ttl == "128" %}
                    <li><strong>Operating system:</strong> Probably Windows due to a TTL value of {{ ttl }}</li>
                    {% endif %}
                    {% if ttl == "64" %}
                    <li><strong>Operating system:</strong> Probably UNIX-like due to a TTL value of {{ ttl }}.</li>
                    {% endif %}
                {% endfor %}

                {% for winver in protocol_info|fields:"BROWSER"|fields:"windows_version" %}
                    {% if winver %}
                    <li><strong>Windows version:</strong> {{ winver }}</li>
                    {% endif %}
                {% endfor %}

                {% for type in protocol_info|fields:"BROWSER"|fields:"device_type" %}
                    {% if type %}
                    <li><strong>Device type:</strong> {{ type }}</li>
                    {% endif %}
                {% endfor %}

                <!-- APPLICATION PORT -->
                {% for port in protocol_info|fields:"BROWSER"|fields:"port" %}
                    {% if port %}
                    <li><strong>Application port:</strong> {{ port }}</li>
                    {% endif %}
                {% endfor %}

                <!-- HOSTNAME -->
                {% for hostname in protocol_info|fields:"BROWSER"|fields:"hostname" %}
                    {% if hostname %}
                    <li><strong>Server hostname:</strong> {{ hostname }}</li>
                    {% endif %}
                {% endfor %}

                <!-- WORKGROUP -->
                {% for wg in protocol_info|fields:"BROWSER"|fields:"workgroup" %}
                    {% if wg %}
                    <li><strong>WORKGROUP:</strong> {{ wg }}</li>
                    {% endif %}
                {% endfor %}

                <!-- EXTRA INFO -->
                {% for extra in protocol_info|fields:"BROWSER"|fields:"extra" %}
                    {% if extra %}
                    <li><strong>Extra info:</strong> {{ extra }}</li>
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
    </div>
