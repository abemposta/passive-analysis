{% load packets_extras %}
    <div class="card">
        <div class="card-header">
            Analysis
        </div>
        <div class="card-body">
            <h5 class="card-title">About SSDP</h5>
            <p class="card-text">The following information was detected analyzing only packets from this protocol:</p>
            <ul>
                <!-- MANUFACTURER -->
                {% for manufacturer in protocol_info|fields:"SSDP"|fields:"manufacturer" %}
                <li><strong>Manufacturer detected:</strong> {{ manufacturer }}</li>
                {% endfor %}

                <!-- IP -->
                {% for ip in protocol_info|fields:"SSDP"|fields:"ip" %}
                <li><strong>IP detected:</strong> {{ ip }}</li>
                {% endfor %}

                <!-- OPERATING SYSTEM -->
                {% for ttl in protocol_info|fields:"SSDP"|fields:"ttl" %}
                    {% if ttl == "128" %}
                    <li><strong>Operating system:</strong> Probably Windows due to a TTL value of {{ ttl }}</li>
                    {% endif %}
                    {% if ttl == "64" %}
                    <li><strong>Operating system:</strong> Probably UNIX-like due to a TTL value of {{ ttl }}.</li>
                    {% endif %}
                {% endfor %}

                {% for winver in protocol_info|fields:"SSDP"|fields:"windows_version" %}
                    {% if winver %}
                    <li><strong>Windows version:</strong> {{ winver }}</li>
                    {% endif %}
                {% endfor %}

                {% for type in protocol_info|fields:"SSDP"|fields:"type" %}
                    {% if type %}
                    <li><strong>Windows version:</strong> {{ type }}</li>
                    {% endif %}
                {% endfor %}

                <!-- APPLICATION PORT -->
                {% for port in protocol_info|fields:"SSDP"|fields:"port" %}
                    {% if port %}
                    <li><strong>Application port:</strong> {{ port }}</li>
                    {% endif %}
                {% endfor %}

                <!-- USER AGENT -->
                {% for ua in protocol_info|fields:"SSDP"|fields:"user_agent" %}
                    {% if ua %}
                    <li><strong>User agent:</strong> {{ ua }}</li>
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
    </div>
